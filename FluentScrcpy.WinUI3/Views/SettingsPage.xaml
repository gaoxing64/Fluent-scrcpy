<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="FluentScrcpy.WinUI3.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Page.Resources>
        <!-- 设置项卡片样式 -->
        <Style x:Key="SettingCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
            <Setter Property="BorderBrush" Value="{ThemeResource CardStrokeColorDefaultBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <!-- 展开/收起动画 -->
        <Storyboard x:Name="ExpandStoryboard">
            <DoubleAnimation
                Storyboard.TargetName="OptionsPanel"
                Storyboard.TargetProperty="Height"
                From="0"
                To="1"
                Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="OptionsPanel"
                Storyboard.TargetProperty="Opacity"
                From="0"
                To="1"
                Duration="0:0:0.2"/>
        </Storyboard>

        <Storyboard x:Name="CollapseStoryboard">
            <DoubleAnimation
                Storyboard.TargetName="OptionsPanel"
                Storyboard.TargetProperty="Height"
                From="1"
                To="0"
                Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="OptionsPanel"
                Storyboard.TargetProperty="Opacity"
                From="1"
                To="0"
                Duration="0:0:0.15"/>
        </Storyboard>
    </Page.Resources>

    <Grid Padding="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock
            Grid.Row="0"
            Text="设置"
            Style="{StaticResource TitleTextBlockStyle}"
            Margin="0,0,0,16"/>

        <ScrollViewer Grid.Row="1">
            <StackPanel Spacing="8">
                
                <!-- 应用语言 -->
                <Border Style="{StaticResource SettingCardStyle}">
                    <StackPanel>
                        <!-- 头部 - 整行可点击 -->
                        <Grid Padding="16" HorizontalAlignment="Stretch" Background="Transparent" PointerPressed="LanguageHeader_PointerPressed">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <FontIcon 
                                Grid.Column="0"
                                Glyph="&#xF2B7;"
                                FontSize="20"
                                Margin="0,0,16,0"
                                VerticalAlignment="Center"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="应用语言" Style="{StaticResource BodyTextBlockStyle}"/>
                                <TextBlock 
                                    x:Name="LanguageValueText"
                                    Text="使用系统设置"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    FontSize="12"/>
                            </StackPanel>
                            
                            <FontIcon 
                                x:Name="LanguageArrowIcon"
                                Grid.Column="2"
                                Glyph="&#xE70D;"
                                FontSize="12"
                                VerticalAlignment="Center"
                                Margin="8,0,0,0">
                                <FontIcon.RenderTransform>
                                    <RotateTransform x:Name="LanguageArrowRotate" Angle="0" CenterX="6" CenterY="6"/>
                                </FontIcon.RenderTransform>
                            </FontIcon>
                        </Grid>
                        
                        <!-- 展开内容 -->
                        <StackPanel x:Name="LanguageOptionsPanel" Visibility="Collapsed" Padding="16,0,16,16" Spacing="8">
                            <RadioButton x:Name="LangSystemRadio" Content="使用系统设置" Checked="LanguageRadio_Checked"/>
                            <RadioButton x:Name="LangChineseRadio" Content="简体中文" Checked="LanguageRadio_Checked"/>
                            <RadioButton x:Name="LangEnglishRadio" Content="English" Checked="LanguageRadio_Checked"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 应用程序主题 -->
                <Border Style="{StaticResource SettingCardStyle}">
                    <StackPanel>
                        <Grid Padding="16" HorizontalAlignment="Stretch" Background="Transparent" PointerPressed="ThemeHeader_PointerPressed">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <FontIcon 
                                Grid.Column="0"
                                Glyph="&#xE790;"
                                FontSize="20"
                                Margin="0,0,16,0"
                                VerticalAlignment="Center"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="应用程序主题" Style="{StaticResource BodyTextBlockStyle}"/>
                                <TextBlock 
                                    x:Name="ThemeValueText"
                                    Text="使用系统设置"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    FontSize="12"/>
                            </StackPanel>
                            
                            <FontIcon 
                                x:Name="ThemeArrowIcon"
                                Grid.Column="2"
                                Glyph="&#xE70D;"
                                FontSize="12"
                                VerticalAlignment="Center"
                                Margin="8,0,0,0">
                                <FontIcon.RenderTransform>
                                    <RotateTransform x:Name="ThemeArrowRotate" Angle="0" CenterX="6" CenterY="6"/>
                                </FontIcon.RenderTransform>
                            </FontIcon>
                        </Grid>
                        
                        <StackPanel x:Name="ThemeOptionsPanel" Visibility="Collapsed" Padding="16,0,16,16" Spacing="8">
                            <RadioButton x:Name="ThemeSystemRadio" Content="使用系统设置" Checked="ThemeRadio_Checked"/>
                            <RadioButton x:Name="ThemeLightRadio" Content="浅色" Checked="ThemeRadio_Checked"/>
                            <RadioButton x:Name="ThemeDarkRadio" Content="深色" Checked="ThemeRadio_Checked"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 背景效果 -->
                <Border Style="{StaticResource SettingCardStyle}">
                    <StackPanel>
                        <Grid Padding="16" HorizontalAlignment="Stretch" Background="Transparent" PointerPressed="BackdropHeader_PointerPressed">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <FontIcon 
                                Grid.Column="0"
                                Glyph="&#xE7B5;"
                                FontSize="20"
                                Margin="0,0,16,0"
                                VerticalAlignment="Center"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="背景效果" Style="{StaticResource BodyTextBlockStyle}"/>
                                <TextBlock 
                                    x:Name="BackdropValueText"
                                    Text="云母 (Mica)"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    FontSize="12"/>
                            </StackPanel>
                            
                            <FontIcon 
                                x:Name="BackdropArrowIcon"
                                Grid.Column="2"
                                Glyph="&#xE70D;"
                                FontSize="12"
                                VerticalAlignment="Center"
                                Margin="8,0,0,0">
                                <FontIcon.RenderTransform>
                                    <RotateTransform x:Name="BackdropArrowRotate" Angle="0" CenterX="6" CenterY="6"/>
                                </FontIcon.RenderTransform>
                            </FontIcon>
                        </Grid>
                        
                        <StackPanel x:Name="BackdropOptionsPanel" Visibility="Collapsed" Padding="16,0,16,16" Spacing="8">
                            <RadioButton x:Name="BackdropMicaRadio" Content="云母 (Mica)" Checked="BackdropRadio_Checked"/>
                            <RadioButton x:Name="BackdropMicaAltRadio" Content="云母变体 (Mica Alt)" Checked="BackdropRadio_Checked"/>
                            <RadioButton x:Name="BackdropAcrylicRadio" Content="亚克力 (Acrylic)" Checked="BackdropRadio_Checked"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 强调色设置 -->
                <Border Style="{StaticResource SettingCardStyle}">
                    <StackPanel>
                        <Grid Padding="16" HorizontalAlignment="Stretch" Background="Transparent" PointerPressed="AccentHeader_PointerPressed">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <FontIcon 
                                Grid.Column="0"
                                Glyph="&#xE73E;"
                                FontSize="20"
                                Margin="0,0,16,0"
                                VerticalAlignment="Center"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="强调色" Style="{StaticResource BodyTextBlockStyle}"/>
                                <TextBlock 
                                    x:Name="AccentColorValueText"
                                    Text="使用系统强调色"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    FontSize="12"/>
                            </StackPanel>
                            
                            <FontIcon 
                                x:Name="AccentArrowIcon"
                                Grid.Column="2"
                                Glyph="&#xE70D;"
                                FontSize="12"
                                VerticalAlignment="Center"
                                Margin="8,0,0,0">
                                <FontIcon.RenderTransform>
                                    <RotateTransform x:Name="AccentArrowRotate" Angle="0" CenterX="6" CenterY="6"/>
                                </FontIcon.RenderTransform>
                            </FontIcon>
                        </Grid>
                        
                        <StackPanel x:Name="AccentOptionsPanel" Visibility="Collapsed" Padding="16,0,16,16" Spacing="12">
                            <ToggleSwitch
                                x:Name="UseSystemAccentToggle"
                                Header="使用系统强调色"
                                IsOn="True"
                                Toggled="UseSystemAccentToggle_Toggled"/>
                            <Button
                                x:Name="PickAccentColorButton"
                                Content="选择自定义颜色"
                                Click="PickAccentColorButton_Click"
                                IsEnabled="False"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 关于 -->
                <Border Style="{StaticResource SettingCardStyle}">
                    <StackPanel>
                        <Grid Padding="16" HorizontalAlignment="Stretch" Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <FontIcon 
                                Grid.Column="0"
                                Glyph="&#xE946;"
                                FontSize="20"
                                Margin="0,0,16,0"
                                VerticalAlignment="Center"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="关于 Fluent Scrcpy" Style="{StaticResource BodyTextBlockStyle}"/>
                                <TextBlock 
                                    Text="版本 1.0.0"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    FontSize="12"/>
                            </StackPanel>
                        </Grid>
                        
                        <Border BorderThickness="1,0,0,0" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}">
                            <StackPanel Padding="16" Spacing="16">
                                <!-- 应用描述 -->
                                <TextBlock 
                                    Text="一个基于 Scrcpy 的现代化 Android 屏幕镜像工具，提供流畅的远程控制体验。"
                                    Style="{StaticResource BodyTextBlockStyle}"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    TextWrapping="Wrap"/>
                                
                                <!-- 开源库 -->
                                <StackPanel>
                                    <TextBlock 
                                        Text="使用的开源库" 
                                        Style="{StaticResource SubtitleTextBlockStyle}"
                                        Margin="0,0,0,8"/>
                                    
                                    <HyperlinkButton 
                                        x:Name="ScrcpyLink"
                                        Content="Scrcpy"
                                        Tag="https://github.com/Genymobile/scrcpy"
                                        Click="GitHubLink_Click"
                                        Margin="0,4,0,4"/>
                                    <TextBlock 
                                        Text="由 Genymobile 开发的核心屏幕镜像功能" 
                                        Style="{StaticResource CaptionTextBlockStyle}"
                                        Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                        Margin="0,0,0,4"/>
                                    
                                    <HyperlinkButton 
                                        x:Name="WinUILink"
                                        Content="WinUI 3"
                                        Tag="https://github.com/microsoft/microsoft-ui-xaml"
                                        Click="GitHubLink_Click"
                                        Margin="0,4,0,4"/>
                                    <TextBlock 
                                        Text="Microsoft 的现代 Windows UI 框架" 
                                        Style="{StaticResource CaptionTextBlockStyle}"
                                        Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                        Margin="0,0,0,4"/>
                                    
                                    <HyperlinkButton 
                                        x:Name="CommunityToolkitLink"
                                        Content="Community Toolkit"
                                        Tag="https://github.com/CommunityToolkit/dotnet"
                                        Click="GitHubLink_Click"
                                        Margin="0,4,0,4"/>
                                    <TextBlock 
                                        Text="Microsoft 开发的 .NET 工具包，提供 MVVM 等功能" 
                                        Style="{StaticResource CaptionTextBlockStyle}"
                                        Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                        Margin="0,0,0,4"/>
                                    
                                    <HyperlinkButton 
                                        x:Name="ColorCodeLink"
                                        Content="ColorCode"
                                        Tag="https://github.com/ChristianFindlay/ColorCode"
                                        Click="GitHubLink_Click"
                                        Margin="0,4,0,4"/>
                                    <TextBlock 
                                        Text="代码语法高亮库" 
                                        Style="{StaticResource CaptionTextBlockStyle}"
                                        Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                        Margin="0,0,0,4"/>
                                </StackPanel>
                                
                                <!-- 法律信息 -->
                                <TextBlock 
                                    Text="本应用基于开源软件构建，遵循相关开源协议。" 
                                    Style="{StaticResource BodyTextBlockStyle}"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
